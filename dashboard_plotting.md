# CREATING DASHBOARDS USING PYTHON-Dash
The goal of this lab is to demonstrate how Python can be used to create interactive dashboards. Note that this lab does not focus chiefly on a great UI (and may break some of the rules), the focus is instead on how to technically achieve the task.

When creating a dashboard, Python considers it as a collection of plots i.e. line graphs, scatter plots, buttons etc. The python module we shall be using is called [Dash](https://dash.plot.ly/). Note that the way Dash works internally is to create a dynamic webpage that contains the plots you instruct it to display. Because of this, you will notice that Dash uses HTML tags to organise content within the page. A knowledge of how html and css works would be absolutely necessary when trying to do advanced things with dash but that is beyond the scope of this course. Some material is included in the further reading section that would increase your proficiency in this field if you need it. In this lab, we shall practise making very simple visualisations using Dash. This should put you in a position to see understand some of the more complex ones presented in the further reading section and also understand what it takes to build a dashboard.

From now on, you shall be the Chief Visualisation Officer(CVO) at ACME inc where your job is to create dashboards. ACME inc generates energy, some of which it uses to run its production lines.

## The Task
It is almost the middle of the year and the company would like to be able to know how its generation business has been doing.
ACME inc runs 5 power plants and 5 motors. In this  bit of the labs, we will focus on the power plants (p1,p2,p3,p4 and p5).

The production (in kW) of the power plants over the first 5 months of this year are shown in the table below:


|     | p1 | p2 | p3 | p4 | p5 |
|-----|----|----|----|----|----|
| Jan | 21 | 10 | 56 | 30 | 8  |
| Feb | 22 | 19 | 50 | 31 | 12 |
| Mar | 27 | 24 | 47 | 25 | 17 |
| Apr | 29 | 22 | 12 | 60 | 13 |
| May | 20 | 16 | 41 | 27 | 9  |


Your task is to create separate dashboards showing the following information:
* TASK 1: Plot a bar graph showing the production of the power plant p2 over the first 5 months of the year.
* TASK 2: p5 is a newer version of p2 that was bought a year ago. Plot a bar graph that shows the production of p2 vs p5 side by side and write a short explanation of whether you think p5 is more efficient than p2. Given that these are both solar photovoltaic plants in similar conditions, which would you say are the 3 sunniest months in this region. All these answers should come from your bar graph that you just plotted.
* TASK 3: Compute (by hand or otherwise) the total generation of each of the power plants and use a suitable visualisation to show these totals relative to each other. This should give us a sense of what chunk of the total power was generated by each of the plants
* TASK 4: For the final piece of information, plot the monthly generation of each of the 5 plants on a single bar chart. On the same page, plot a pie chart that contains the total annual generation for each of the 5 plant.

The following instructions should help you complete these tasks.

### TASK 0: Install necessary software
There are many tools available in Python for creating visualisations (plots, charts etc). These include matplotlib, plotly, plotly_express and many other less popular more niche ones. Dash, which we use in this lab, uses [plotly](https://plot.ly/python/getting-started/) in the backend. It is important to know this because some things in the Dash documentation are glossed over as they are concepts from plotly.
To do this lab, you will need to install Dash. From your terminal use, `$ pip3 install dash`. This assumes that you are using Python3 which we shall use. All this will still work on Python 2 but you shouldn't be using Python 2 as it will be [deprecated in a few months](https://pythonclock.org/).

### TASK 1: Plot a bar graph showing the production of the power plant p2 over the first 5 months of the year
Open a Python script and insert the following code ```TODO: Should this be given as a file or included inline?```:
```python
import dash
import dash_core_components as dcc 	#This library will give us the dashboard elements (pie charts, scatter plots, bar graphs etc)
import dash_html_components as html 	#This library allows us to arrange the elements from dcc in a page as is done using html/css (how the internet generally does it)

#Fancy Styles and fonts provided to us by nice people
external_stylesheets = ['https://codepen.io/chriddyp/pen/bWLwgP.css']


app = dash.Dash(__name__, external_stylesheets=external_stylesheets)

months = ['Jan', 'Feb', 'Mar', 'Apr', 'May'] #Will form our x-axis later
p2_prod = [10,19,24,22,16]	#production of p2 as a list

# This structure represents the bar graph
# id: The html id of the bar graph
# figure: info that actually goes into the bar graph. It is a python dictionary
# data: The data for the x and y axis. The type of the graph and the name of the graph. Different types and names documented by plotly (https://plot.ly/python/bar-charts/) or (https://plot.ly/python/)
# layout: A dict containing various attributes. The full list of possibilities lives in dcc code(https://github.com/plotly/plotly.py/blob/master/plotly/graph_objs/layout/__init__.py) <If you actually make it here, search the document for the word "setter" and should see other properties that you can set as font, color, gridcolor, gridwidth etc>
bar2 = dcc.Graph(
        id='barChart-p2',	
        figure={
            'data': [
                {'x': months, 'y': p2_prod, 'type': 'bar', 'name': 'P2'}
                    ],
            'layout': {
                'title': 'Powerplant p2 production'
            }
        }
    )

#This structure draws the layout of the dashboard page itself. An HTML page is drawn as a series of boxes. If box C is inside box P, box C is said to be a child of the box P. The overall "box" is called an html.div

#In this case, the structure is:
	# *html.h1
	# *html.Div
	# *bar2
# In future labs, you shall see boxes inside boxes. To draw the layout of the page, it is important which elements are children of which other elements
app.layout = html.Div(children=[
    html.H1(children='ALU AIIP'),

    html.Div(children='''
        ACME inc's web dashboard. Built using Dash: A web application framework for Python.
    '''),
    bar2
])
```

On your own, plot a graph showing the production of the powerplant p5 on a bar chart.

## TASK 2: Plot production of p2 and p5 side by side
Some part of your code will need to change to:
```python
bar2 = dcc.Graph(
        id='barChart-p2&p5',
        figure={
            'data': [
                {'x': months, 'y': p2_prod, 'type': 'bar', 'name': 'P2'},
                {'x': months, 'y': p5_prod, 'type': 'bar', 'name': 'P5'},
                    ],
            'layout': {
                'title': 'Powerplant p2&p5 comparison'
            }
        }
    )
```
Note that there are other parts of your code that will need to change. Change these as necessary. You may consult [a very similar online example](https://dash.plot.ly/getting-started) or the course instructors for help.

## TASK 3: Compare the total generation for each of the power plants
Create a suitable visualisation to  compare the total production from each of the plants over the months shown. In order to do this, you will probably need the following code:

```python

pie = dcc.Graph(
        id='pieChart-p1-p5',
        figure={
            'data': [
                {'labels': ['p1', 'p2', 'p3', 'p4','p5'], 'values': [sum(p1_prod),sum(p2_prod),sum(p3_prod),sum(p4_prod),sum(p5_prod)], 'type': 'pie', 'name': 'prod_pie'},
                    ],
            'layout': {
                'title': 'Total Jan-May production'
            }
        }
    )
```


## TASK 4: Show total generation for all 5 plants and compare the totals, using 2 visualisations on the same page
The following code is provided that does this task for p1-p3. Extend it to work for all 5 plants:
```python
bar3 = dcc.Graph(
        id='barChart-p1-p3',
        figure={
            'data': [
                {'x': months, 'y': p1_prod, 'type': 'bar', 'name': 'P1'},
                {'x': months, 'y': p2_prod, 'type': 'bar', 'name': 'P2'},
                {'x': months, 'y': p3_prod, 'type': 'bar', 'name': 'P3'},
                    ],
            'layout': {
                'title': 'Powerplant p1-p3 production'
            }
        }
    )

pie3 = dcc.Graph(
        id='pieChart-p1-p3',
        figure={
            'data': [
                {'labels': ['p1', 'p2', 'p3'], 'values': [sum(p1_prod),sum(p2_prod),sum(p3_prod)], 'type': 'pie', 'name': 'prod_pie'},
                    ],
            'layout': {
                'title': 'Total Jan-May production (p1-p3)'
            }
        }
    )

app.layout = html.Div(children=[
    html.H1(children='ALU AIIP'),

    html.Div(children='''
        ACME inc's web dashboard. Built using Dash: A web application framework for Python.
    '''),
    bar3,
    pie
])

```

# Further reading
This first set of readings is to understand HTML/CSS
* HTML, CSS - How to make a styled webpage. [YouTube video](https://www.youtube.com/watch?v=gQojMIhELvM&list=PLoYCgNOIyGABDU532eesybur5HPBVfC1G)

There are some advanced Dash concepts that we have not covered in this lab that may be particularly useful to some covered in the next readings:
* Make a dashboard that refreshes its data source every few seconds (streaming dashboard) [raw code](https://github.com/alysivji/talks/blob/master/data-science-workflows-using-docker-containers/workflow3-data-driven-app/plot_timeseries.py) from [a comprehensive talk](https://www.youtube.com/watch?v=oO8n3y23b6M)
* Make a [dashboard with options](https://dash.plot.ly/getting-started-part-2) (See the section labelled Multiple Inputs) to display different things
* Make a [complex business dashboard](https://towardsdatascience.com/how-to-build-a-complex-reporting-dashboard-using-dash-and-plotl-4f4257c18a7f) with many options to select from and many plots
